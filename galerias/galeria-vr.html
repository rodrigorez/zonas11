<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zonas 11 - Galeria VR (V2.8)</title>
    <style>
      body { margin: 0; overflow: hidden; }
    </style>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="assets/js/enhanced-controls.js"></script>
    <script src="assets/js/navigation-helper.js"></script>
    <!--
    =====================================================
    ZONAS 11 - GALERIA PRINCIPAL VR (V2.8)
    =====================================================
    
    DESCRI√á√ÉO:
    - Galeria de Realidade Virtual com navega√ß√£o livre
    - 10 objetos 3D flutuantes representando 10 mundos VR
    - 70 obras de arte distribu√≠das em 10 mundos
    - Objetos 3D clic√°veis com redirecionamento
    
    ESTRUTURA DOS MUNDOS:
    - Objeto 01.glb (0¬∞)   ‚Üí Mundo 1: Obras 1-7   (index2.html?from=vr)
    - Objeto 02.glb (36¬∞)  ‚Üí Mundo 2: Obras 8-14  (index3.html?from=vr)
    - Objeto 03.glb (72¬∞)  ‚Üí Mundo 3: Obras 15-21 (index4.html?from=vr)
    - Objeto 04.glb (108¬∞) ‚Üí Mundo 4: Obras 22-28 (index5.html?from=vr)
    - Objeto 05.glb (144¬∞) ‚Üí Mundo 5: Obras 29-37 (index6.html?from=vr)
    - Objeto 06.glb (180¬∞) ‚Üí Mundo 6: Obras 38-42 (index7.html?from=vr)
    - Objeto 07.glb (216¬∞) ‚Üí Mundo 7: Obras 43-48 (index8.html?from=vr)
    - Objeto 08.glb (252¬∞) ‚Üí Mundo 8: Obras 49-55 (index9.html?from=vr)
    - Objeto 09.glb (288¬∞) ‚Üí Mundo 9: Obras 57-63 (index10.html?from=vr)
    - Objeto 10.glb (324¬∞) ‚Üí Mundo 10: Obras 65-70 (index11.html?from=vr)
    
    FUNCIONALIDADES:
    - Navega√ß√£o livre: WASD + Mouse (rota√ß√£o horizontal + vertical)
    - Modelos 3D: .glb com anima√ß√µes org√¢nicas
    - Cores: Material vermelho (#FF0000) padronizado
    
    INTERA√á√ÉO:
    - Clique no objeto: Redireciona para mundo VR com ?from=vr
    - Navega√ß√£o preserva contexto VR em toda cadeia
    
    DISPOSI√á√ÉO CIRCULAR:
    - Raio: 4 metros
    - Altura: 1.6 metros (n√≠vel dos olhos)
    - √Çngulos: 0¬∞, 36¬∞, 72¬∞, 108¬∞, 144¬∞, 180¬∞, 216¬∞, 252¬∞, 288¬∞, 324¬∞
    ====================================================
    -->
  </head>
  <body>
    <a-scene
      cursor="rayOrigin: mouse"
      vr-mode-ui="enabled: true"
    >
      <!-- üñºÔ∏è FUNDO 360¬∞ -->
      <a-sky color="#0a0a0a"></a-sky>

      <!-- ===============================================
           OBJETOS 3D - 10 MUNDOS (DISPOSI√á√ÉO CIRCULAR)
           =============================================== -->

      <!-- MUNDO 1 - Posi√ß√£o 0¬∞ (Norte) -->
      <a-entity 
        class="world-portal mundo1"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/01.glb" 
        position="0 1.6 -4"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: 0 2.2 -4; dur: 3000; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 4200; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 2 - Posi√ß√£o 36¬∞ -->
      <a-entity 
        class="world-portal mundo2"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/02.glb" 
        position="2.35 1.6 -3.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: 2.35 2.2 -3.24; dur: 3200; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 3800; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 3 - Posi√ß√£o 72¬∞ -->
      <a-entity 
        class="world-portal mundo3"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/03.glb" 
        position="3.81 1.6 -1.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: 3.81 2.2 -1.24; dur: 2800; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 4600; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 4 - Posi√ß√£o 108¬∞ -->
      <a-entity 
        class="world-portal mundo4"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/04.glb" 
        position="3.81 1.6 1.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: 3.81 2.2 1.24; dur: 3400; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 3600; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 5 - Posi√ß√£o 144¬∞ -->
      <a-entity 
        class="world-portal mundo5"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/05.glb" 
        position="2.35 1.6 3.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: 2.35 2.2 3.24; dur: 3600; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 6 - Posi√ß√£o 180¬∞ -->
      <a-entity 
        class="world-portal mundo6"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/06.glb" 
        position="0 1.6 4"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: 0 2.2 4; dur: 3800; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 4200; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 7 - Posi√ß√£o 216¬∞ -->
      <a-entity 
        class="world-portal mundo7"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/07.glb" 
        position="-2.35 1.6 3.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: -2.35 2.2 3.24; dur: 3300; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 3900; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 8 - Posi√ß√£o 252¬∞ -->
      <a-entity 
        class="world-portal mundo8"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/08.glb" 
        position="-3.81 1.6 1.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: -3.81 2.2 1.24; dur: 3100; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 4100; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 9 - Posi√ß√£o 288¬∞ -->
      <a-entity 
        class="world-portal mundo9"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/09.glb" 
        position="-3.81 1.6 -1.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: -3.81 2.2 -1.24; dur: 2900; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 3700; easing: linear; loop: true"
      ></a-entity>

      <!-- MUNDO 10 - Posi√ß√£o 324¬∞ (NOVO) -->
      <a-entity 
        class="world-portal mundo10"
        gltf-model="https://rodrigorez.github.io/zonas11/galerias/assets/3d/10.glb" 
        position="-2.35 1.6 -3.24"
        scale="0.8 0.8 0.8"
        animation__float="property: position; to: -2.35 2.2 -3.24; dur: 3500; easing: easeInOutSine; loop: true; dir: alternate"
        animation__rotate="property: rotation; to: 0 360 0; dur: 4300; easing: linear; loop: true"
      ></a-entity>

      <!-- üëÅÔ∏è C√¢mera com Enhanced Controls -->
      <a-entity 
        camera 
        look-controls
        enhanced-controls="rotationSpeed: 45; enableRotation: false; enableMovement: true; moveSpeed: 3; enableMouseDrag: true; mouseDragSpeed: 0.01"
        position="0 1.6 0"
      ></a-entity>
    </a-scene>

    <script>
      // Componente de redirecionamento (reutilizado do sistema existente)
      AFRAME.registerComponent('redirect-on-click', {
        schema: { url: { type: 'string', default: '#' } },
        init: function () {
          const el = this.el;
          const url = this.data.url;

          el.addEventListener('click', () => {
            el.setAttribute('scale', '1.2 1.2 1.2');
            setTimeout(() => {
              window.location.href = url;
            }, 300);
          });
        }
      });

      document.addEventListener('DOMContentLoaded', () => {
        console.log('ü•Ω Galeria VR: Inicializando...');
        
        // Configura√ß√£o dos portais para os 10 mundos
        // Cada portal redireciona para seu mundo com par√¢metro ?from=vr
        const portals = [
          { class: 'mundo1', mundoNum: 2, nome: 'Mundo 1 (Obras 1-7)' },
          { class: 'mundo2', mundoNum: 3, nome: 'Mundo 2 (Obras 8-14)' },
          { class: 'mundo3', mundoNum: 4, nome: 'Mundo 3 (Obras 15-21)' },
          { class: 'mundo4', mundoNum: 5, nome: 'Mundo 4 (Obras 22-28)' },
          { class: 'mundo5', mundoNum: 6, nome: 'Mundo 5 (Obras 29-37)' },
          { class: 'mundo6', mundoNum: 7, nome: 'Mundo 6 (Obras 38-42)' },
          { class: 'mundo7', mundoNum: 8, nome: 'Mundo 7 (Obras 43-48)' },
          { class: 'mundo8', mundoNum: 9, nome: 'Mundo 8 (Obras 49-55)' },
          { class: 'mundo9', mundoNum: 10, nome: 'Mundo 9 (Obras 57-63)' },
          { class: 'mundo10', mundoNum: 11, nome: 'Mundo 10 (Obras 65-70)' }
        ];
        
        // Configurar cada portal
        portals.forEach(portal => {
          const entity = document.querySelector(`.${portal.class}`);
          
          if (entity) {
            // Gerar URL do mundo com par√¢metro ?from=vr
            const mundoURL = getMundoURL(portal.mundoNum, 'vr');
            
            // Configurar redirecionamento
            entity.setAttribute('redirect-on-click', { url: mundoURL });
            console.log(`üåç Portal configurado: ${portal.nome} ‚Üí ${mundoURL}`);
            
            // Aplicar cor vermelha ao modelo 3D quando carregar
            entity.addEventListener('model-loaded', () => {
              console.log(`üî¥ Aplicando cor vermelha ao ${portal.nome}`);
              
              // Aguardar um frame para garantir que o modelo esteja totalmente carregado
              setTimeout(() => {
                const mesh = entity.getObject3D('mesh');
                
                if (mesh) {
                  let materialsCount = 0;
                  
                  // Percorrer todos os materiais do modelo
                  mesh.traverse((child) => {
                    if (child.isMesh && child.material) {
                      materialsCount++;
                      
                      // Aplicar cor vermelha (#FF0000)
                      if (Array.isArray(child.material)) {
                        // Material √© array
                        child.material.forEach((mat, index) => {
                          mat.color.setHex(0xFF0000);
                          mat.emissive.setHex(0x220000);
                          mat.needsUpdate = true;
                        });
                      } else {
                        // Material √∫nico
                        child.material.color.setHex(0xFF0000);
                        child.material.emissive.setHex(0x220000);
                        child.material.needsUpdate = true;
                      }
                    }
                  });
                  
                  console.log(`‚úÖ Cor vermelha aplicada em ${materialsCount} materiais de ${portal.nome}`);
                } else {
                  console.warn(`‚ö†Ô∏è Mesh n√£o encontrada em ${portal.nome}`);
                }
              }, 100);
            });
          } else {
            console.error(`‚ùå Portal n√£o encontrado: ${portal.class}`);
          }
        });
        
        console.log('‚úÖ Galeria VR: Inicializa√ß√£o completa');
        console.log('üìã Controles dispon√≠veis:');
        console.log('   - W/A/S/D: Movimento');
        console.log('   - Mouse: Olhar ao redor + Rota√ß√£o');
        console.log('   - Clique: Acessar mundo VR');
      });
    </script>
  </body>
</html>
